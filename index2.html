<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FindSell HomePage2</title>
    <link rel="stylesheet" href="index2Style.css">
</head>
<body>
    <header class="header">
        <div class="top-bar">
            <div class="container">
                <p>Welcome! <span id="usrem"></span></p>
            </div>
        </div>
        
        <div class="main-header">
            <div class="container">
                <div class="header-content">
                    <div class="logo">
                        <a href="http://127.0.0.1:5500/index2.html">
                            <img src="Selling_transparent-.png" alt="FindSell Logo">
                        </a>
                    </div>
                    
                    <div class="search-wrapper">
                        <input type="text" class="search-input" placeholder="Search for items...">
                        <button class="search-button">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
                        </button>
                    </div>
                    
                    <div class="auth-buttons">
                        <button class="btn-auth" id="account-btn">My Account</button>
                        <section class="dropdown">
                            <div class="tag"><a href="http://127.0.0.1:5500/myaccount.html">My Account</a></div>
                            <div class="tag"><a href='http://127.0.0.1:5500/myproduct.html'>My Products</a></div>
                            <div class="tag"><a href='http://127.0.0.1:5500/myfriend.html'>My Friends</a></div>
                            <div class="tag"><a href='http://127.0.0.1:5500/myaward.html'>Awards</a></div>
                        </section>
                        <a href="http://127.0.0.1:5500/product.html" class="btn-sell">Sell</a>
                    </div>
                </div>
            </div>
        </div>

        <nav class="categories-nav">
            <div class="container">
                <ul class="nav-list">
                    <li><a href="#" class="nav-link">Saved</a></li>
                    <li><a href="#" class="nav-link">Electronics</a></li>
                    <li><a href="#" class="nav-link">Fashion</a></li>
                    <li><a href="#" class="nav-link">Jewellery and Watches</a></li>
                    <li><a href="#" class="nav-link">Toys</a></li>
                    <li><a href="#" class="nav-link">Collectables</a></li>
                    <li><a href="#" class="nav-link">Home</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <main class="main-content">
        <div class="container">
            <section class="game-section" id="game">
                <div class="game-slide active">
                    <div class="game-content">
                        <h2>Welcome To FindSell</h2>
                        <p>Check In To Get More Reward!</p>
                        <button id="check" class="game-btn">Go To Checking Centre!</button>
                        <button class="next-btn">Next</button>
                    </div>
                </div>
                
                <div class="game-slide">
                    <div class="game-content">
                        <h2>Fun Game</h2>
                        <p>Win The Game For More Award!</p>
                        <button id="go" class="game-btn">Let's Start</button>
                        <button class="next-btn">Previous</button>
                    </div>
                </div>
            </section>

            <section class="trusted-sellers">
                <h2>Trusted Sellers</h2>
                <button id="but2" class="scroll-btn">Next</button>
                <div class="sellers-container">
                    <div id="seller" class="sellers-scroll">
                        <!-- Sellers will be loaded here dynamically -->
                    </div>
                </div>
            </section>

            <section class="for-you">
                <h2>Recommended for You</h2>
                <div class="products-grid">
                    <div class="product-card">
                        <div class="product-image"></div>
                        <div class="product-info">
                            <h3>Product Title</h3>
                            <p class="price">$199.99</p>
                        </div>
                    </div>
                    <!-- Repeat product cards as needed -->
                </div>
            </section>
        </div>
    </main>

    <script>
        // Initialize variables
        const account = "https://jackm-ff5c.restdb.io/rest/account";
        const api = "678fa7439bd0c87432ac8bee";
        const usrmail = localStorage.getItem("usremail");
        const idnum = localStorage.getItem("usrid");
        
        document.getElementById("usrem").innerHTML = usrmail;

        // Account dropdown functionality
        const accountBtn = document.getElementById('account-btn');
        const dropdown = document.querySelector('.dropdown');
        
        accountBtn.addEventListener('click', (event) => {
            event.stopPropagation();
            dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
        });

        document.addEventListener('click', (event) => {
            if (!dropdown.contains(event.target) && event.target !== accountBtn) {
                dropdown.style.display = 'none';
            }
        });

        // Game section functionality
        const checkBtn = document.getElementById('check');
        const goBtn = document.getElementById('go');
        const gameSection = document.getElementById('game');
        const nextBtns = document.getElementsByClassName('next-btn');
        const slides = gameSection.getElementsByClassName('game-slide');
        let currentSlide = 0;

        checkBtn.addEventListener('click', () => {
            window.location.href = "http://127.0.0.1:5500/checkin.html";
        });

        goBtn.addEventListener('click', () => {
            window.location.href = "http://127.0.0.1:5500/game.html";
        });

        Array.from(nextBtns).forEach(btn => {
            btn.addEventListener('click', () => {
                slides[currentSlide].classList.remove('active');
                currentSlide = currentSlide === 0 ? 1 : 0;
                slides[currentSlide].classList.add('active');
            });
        });

        // Fetch and display sellers
        fetch(account, {
            method: "GET",
            headers: {
                "Content-Type": "application/json",
                "x-apikey": api,
                "Cache-Control": "no-cache",
            },
        })
        .then(response => response.json())
        .then(data => {
            const sellersContainer = document.getElementById("seller");
            const filteredData = data.filter(account => account.usrid !== idnum);
            
            filteredData.forEach(account => {
                const sellerCard = document.createElement("div");
                sellerCard.className = "seller-card";
                
                const avatar = document.createElement('img');
                avatar.src = account.avatar;
                avatar.className = "seller-avatar";
                avatar.addEventListener("click", () => {
                    localStorage.setItem("selectedUser", JSON.stringify({
                        otherid: account.usrid,
                        otheremail: account.email,
                        otherbio: account.bio,
                        otheravatar: account.avatar,
                        othername: account.name
                    }));
                    window.location.href = 'http://127.0.0.1:5500/user.html';
                });
                
                const name = document.createElement("h3");
                name.textContent = account.name || "User";
                
                const email = document.createElement("p");
                email.textContent = account.email || "No Email";
                
                sellerCard.appendChild(avatar);
                sellerCard.appendChild(name);
                sellerCard.appendChild(email);
                
                sellersContainer.appendChild(sellerCard);
            });

            // Initialize scroll functionality
            initializeScroll();
        })
        .catch(error => console.error('Error:', error));

        function initializeScroll() {
            const container = document.querySelector('.sellers-container');
            const scrollContent = document.getElementById('seller');
            const scrollLeftBtn = document.getElementById('scroll-left');
            const scrollRightBtn = document.getElementById('scroll-right');
            const cardWidth = 315; // 300px card width + 15px gap
            let scrollPosition = 0;

            // Initially hide "Previous" button
            scrollLeftBtn.style.display = 'none';

            scrollLeftBtn.addEventListener('click', () => {
                scrollPosition = Math.max(scrollPosition - cardWidth, 0);
                updateScroll();
            });

            scrollRightBtn.addEventListener('click', () => {
                const maxScroll = scrollContent.scrollWidth - container.clientWidth;
                scrollPosition = Math.min(scrollPosition + cardWidth, maxScroll);
                updateScroll();
            });

            function updateScroll() {
                scrollContent.style.transform = `translateX(-${scrollPosition}px)`;
                
                // Update button visibility
                scrollLeftBtn.style.display = scrollPosition > 0 ? 'inline-block' : 'none';
                scrollRightBtn.style.display = 
                    scrollPosition < (scrollContent.scrollWidth - container.clientWidth) 
                    ? 'inline-block' 
                    : 'none';
            }

            // Initial check for button visibility 
            updateScroll();

            // Update on window resize
            window.addEventListener('resize', updateScroll);
        }
    </script>
</body>
</html>