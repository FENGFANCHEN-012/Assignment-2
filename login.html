<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Log in/sign up</title>
    <link rel="stylesheet" href="combined_style.css">

   
<body>
    <header>
  
        <div class="head" style="position:absolute">
            <a href="index.html"><img class="logo"src= "Selling_transparent-.png" alt="Find Sell"></a>
             <input type="text" class="search" >
             <button class="bt">Search</button>
            <button class="set">Login</button>
            <button class="set" style="margin-left:0">Sign Up</button>
            <div class="set" style="width:7vw;margin-left:1vw" ><button class="inbt"  >Sell</button></div>
        </div>
      </header>
      <div >&nbsp  &nbsp  &nbsp  &nbsp </div>
      <section class="main" style="height:60vw;align-items:start;margin-top:5vw">
          
        
        <div class="lgif">
            <hr style="margin-top: 3vw;">
           
           <section style="margin-top: 10vw;">
            Welcome!</section> 
           
           <section style="margin-top: 10vw;">
            <div>Log in FindSell</div>


            <form id="login">
                <div>
                    <label >Email</label>
                    <input id="email" type="text">
                </div>
                <div style="margin-top: 10px;">
                    <label>Password</label>
                    <input id="passwd" type="password">
                </div>
                <button  type="submit" style="margin-left:5vw">Submit</button>
            </form>

                <section>Don't have an account?<a href='sign%20up.html'>Sign up Here</a></section>
               
        </div>
    </section>

</section>
<footer class="footer">Hi</footer>
<script>
    
  document.addEventListener("DOMContentLoaded", function(){
APIKEY="67971683f9d2bb616f181e2b";


let login = document.getElementById("login")
login.addEventListener("submit",  async  function (event){
event.preventDefault();
let email = document.getElementById("email").value
let passwd = document.getElementById("passwd").value

if (!email || !passwd) {
    alert("Email and Password cannot be empty!");
    return;
}
let settings = {
    method:"GET",
    headers:{
      "Content-Type": "application/json",
        "x-apikey": APIKEY,
        "Cache-Control": "no-cache",
        
    }
  };
  try{                   
  let search = await fetch("https://assignmentfed-fb7a.restdb.io/rest/account", settings)
  
  const data = await search.json();
    let check = false;
     for(let i of data){
        if(i.email===email && i.passwd===passwd){
            alert("Log in successful. Welcome to FindSell!")
            check=true;
            localStorage.setItem("usrid",i.usrid)
            localStorage.setItem("usremail",i.email)
            localStorage.setItem("usrpasswd",i.passwd)
         
            window.location.assign("index2.html")
            break;
        }
        

     }
     if(!check){
        alert("Invalid email or password, try again.")
     }
  }
catch(error){
    alert("Error Occurred during login. Please try again",error)
}
})


}
)
    
  
  
 
  
  
 
   
      
</script>

</body>
</html>